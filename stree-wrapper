#!/bin/bash
# Find project root by looking for .streerc
find_project_root() {
    local dir="$PWD"
    while [ "$dir" != "/" ]; do
        if [ -f "$dir/.streerc" ]; then
            echo "$dir"
            return 0
        fi
        dir="$(dirname "$dir")"
    done
    echo "$PWD"
}

PROJECT_ROOT=$(find_project_root)

# Read stdin into variable
INPUT=$(cat)

# Format using -e flag with the input
cd "$PROJECT_ROOT" && bundle exec stree format -e "$INPUT"
